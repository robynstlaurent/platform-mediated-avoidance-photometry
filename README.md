# platform-mediated-avoidance-photometry
Alignment of TDT fiber photometry recordings with DeepLabCut and StateScript behavior tracking during platform-mediated avoidance procedure for mice.
Example data output, graphs, and detailed methods can be found at https://doi.org/10.1016/j.biopsych.2024.10.021

# Fiber Photometry + DeepLabCut + Behavioral State Alignment (MATLAB-based pipeline)

This repository contains a reproducible demonstration of how to integrate and analyze multimodal neuroscience data streams using MATLAB.  
It includes example code for:

- Loading and preprocessing fiber photometry data collected on TDT photometry system (https://www.tdt.com/system/fiber-photometry-system/)
- Integrating pose estimation output from DeepLabCut: Transformed from video input to csv output using Jupyter notebook and DeepLabCut trained networks
- Incorporating behavioral state information collected using StateScript from SpikeGadgets (https://spikegadgets.com/products/statescript/) 
- Aligning asynchronous data streams onto a unified timeline  
- Producing analysis-ready signals and visualizations  

---

## ðŸ”§ Project Structure
photometry-video-behavior-alignment/
â”‚
â”œâ”€â”€ code/                      # MATLAB analysis scripts
|   â”œâ”€â”€ get_fNames_AA.m        # Choose cohort to analyze (list of filenames)
â”‚   â”œâ”€â”€ TDT2MAT.m              # Photometry: Batch convert raw TDT to MATLAB structure 
â”‚   â”œâ”€â”€ Phot2PhotoSig.m        # Photometry: Batch analyze photometry signal - remove artifacts
â”‚   â”œâ”€â”€ batch_platformTimev3.m # Aligns timestamps across data streams
â”‚   â”œâ”€â”€ load_AA_data.m         # Loads photometry, DLC, and behavior data
â”‚   â”œâ”€â”€ batch_TonexPhot.m      # Performs analysis and generates figures
â”‚   â”œâ”€â”€ batch_ShockxPhot.m     # Performs analysis and generates figures
â”‚   â””â”€â”€ batch_RewardxPhot.m    # Performs analysis and generates figures
â”‚
â”œâ”€â”€ data_example/              # Synthetic datasets for demonstration
â”‚   â”œâ”€â”€ fp_example.csv         # Example photometry signal
â”‚   â”œâ”€â”€ dlc_example.csv        # Example DeepLabCut pose output
â”‚   â””â”€â”€ behavior_states.csv    # Example behavioral state start/stop times
â”‚
â”œâ”€â”€ figures/                   # Figures generated by the pipeline
â”‚   â”œâ”€â”€ photometry_trace.png
â”‚   â”œâ”€â”€ dlc_aligned.png
â”‚   â””â”€â”€ behavior_overlay.png
â”‚
â”œâ”€â”€ .gitignore                # Specifies files Git should ignore
â”œâ”€â”€ LICENSE                   # MIT License
â””â”€â”€ README.md                 # Project overview and instructions

